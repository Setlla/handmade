/*! handmade 07-02-2017 */
var restify=require("restify"),index=require("./routes/main"),ip_addr="127.0.0.1",port="8080",server=restify.createServer({name:"handmade"});server.use(restify.queryParser()),server.use(restify.bodyParser()),server.use(restify.CORS()),server.get("/hello",index.list),server.del("/hello/:ID",index.deleteOne),server.post("/hello/:name",index.findOne),server.listen(port,ip_addr,function(){console.log("%s listening at %s ",server.name,server.url)});var mysql=require("mysql2"),pool=mysql.createPool({host:"192.168.1.250",user:"hsp",password:"123456",database:"hsp2",port:3306,useConnectionPooling:!0});module.exports=pool;var pool=require("../db/conn"),list=function(a,b,c){pool.getConnection(function(a,d){return d.query({sql:"select * from facstate"},function(a,c,e){if(d.release(),a)throw a;console.log("The ID is: ",title=c[0].ID),b.charSet("utf-8"),b.send(200,b.json(c))}),c()})},findOne=function(a,b,c){pool.getConnection(function(d,e){return e.prepare({sql:"select * from facstate where Name LIKE ?"},function(c,d){if(c)throw c;d.execute([a.params.name],function(a,c,e){if(d.close(),a)throw a;console.log("The ID is: ",title=c),b.charSet("utf-8"),b.send(200,b.json(c))})}),c()})},deleteOne=function(a,b,c){b.send("hello test "+a.params.name),c()};module.exports.list=list,module.exports.findOne=findOne,module.exports.deleteOne=deleteOne;